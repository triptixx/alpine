language: none

branches:
  only:
    - master

integrations:
  hub:
    - integrationName: DockerHub
      type: dockerRegistryLogin

env:
  matrix:
    - ALPINE_TAG: '3.7'
    - ALPINE_TAG: '3.8'
    - ALPINE_TAG: '3.9'
    - ALPINE_TAG: ['3.10','latest']

build:
  pre_ci:
#    - echo "building image ${ORG_NAME}/${REPO_NAME}:${ALPINE_TAG%%,*}"
    - docker build --build-arg ALPINE_TAG=${ALPINE_TAG%%,*} -t ${ORG_NAME}/${REPO_NAME}:${ALPINE_TAG%%,*} .
  pre_ci_boot:
    image_name: ${ORG_NAME}/${REPO_NAME}
    image_tag: ${ALPINE_TAG%%,*}
    pull: false
  ci:
    - su-exec nobody apk --version
